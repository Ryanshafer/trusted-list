import{j as l}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.DMVOjPfi.js";const U="153, 143, 132",K="0, 163, 173",V="153, 143, 132",I="0, 163, 173",P="vector-field-config-sync";let _=!1;const W={desktopParticleCount:100,mobileParticleCount:50,mobileMaxWidth:767,desktopConnectionDistance:150,mobileConnectionDistance:95,desktopClumpNeighborDistance:88,mobileClumpNeighborDistance:56,desktopClumpMinNeighbors:4,mobileClumpMinNeighbors:4,linkOpacity:.32,pulseSpeed:4,pulseSpawnChance:8e-4,pulseMinLinkDistance:48,pulseCoreRadius:1,pulseGlowRadius:4,maxActivePulses:16,attractionDistance:300,attractionForce:.08,velocityDamping:.97,repulsionDistance:80,repulsionForce:.002,nodeMinSize:4,nodeMaxSize:12,nodeMinAlpha:.05,nodeAlphaRange:.2};let B={...W};const Y=[{key:"desktopParticleCount",label:"Desktop particles",min:40,max:240,step:1,integer:!0},{key:"mobileParticleCount",label:"Mobile particles",min:20,max:140,step:1,integer:!0},{key:"mobileMaxWidth",label:"Mobile breakpoint",min:480,max:1024,step:1,integer:!0},{key:"desktopConnectionDistance",label:"Desktop connection distance",min:70,max:240,step:1,integer:!0},{key:"mobileConnectionDistance",label:"Mobile connection distance",min:40,max:180,step:1,integer:!0},{key:"desktopClumpNeighborDistance",label:"Desktop clump distance",min:30,max:180,step:1,integer:!0},{key:"mobileClumpNeighborDistance",label:"Mobile clump distance",min:20,max:120,step:1,integer:!0},{key:"desktopClumpMinNeighbors",label:"Desktop clump neighbors",min:2,max:12,step:1,integer:!0},{key:"mobileClumpMinNeighbors",label:"Mobile clump neighbors",min:2,max:10,step:1,integer:!0},{key:"linkOpacity",label:"Link opacity",min:.05,max:.8,step:.01},{key:"pulseSpeed",label:"Pulse speed",min:.5,max:8,step:.1},{key:"pulseSpawnChance",label:"Pulse spawn chance",min:2e-4,max:.012,step:2e-4},{key:"pulseMinLinkDistance",label:"Pulse min link distance",min:10,max:140,step:1,integer:!0},{key:"pulseCoreRadius",label:"Pulse core radius",min:.6,max:4,step:.1},{key:"pulseGlowRadius",label:"Pulse glow radius",min:2,max:18,step:.1},{key:"maxActivePulses",label:"Max active pulses",min:2,max:100,step:1,integer:!0},{key:"attractionDistance",label:"Mouse attraction distance",min:40,max:480,step:1,integer:!0},{key:"attractionForce",label:"Mouse attraction force",min:0,max:.25,step:.005},{key:"velocityDamping",label:"Velocity damping",min:.9,max:.995,step:.001},{key:"repulsionDistance",label:"Repulsion distance",min:20,max:200,step:1,integer:!0},{key:"repulsionForce",label:"Repulsion force",min:2e-4,max:.01,step:1e-4},{key:"nodeMinSize",label:"Node min size",min:2,max:14,step:.2},{key:"nodeMaxSize",label:"Node max size",min:3,max:20,step:.2},{key:"nodeMinAlpha",label:"Node min alpha",min:.01,max:.5,step:.01},{key:"nodeAlphaRange",label:"Node alpha range",min:.02,max:.6,step:.01}],X=(m,d)=>d>=1?String(Math.round(m)):d>=.1?m.toFixed(1):d>=.01?m.toFixed(2):d>=.001?m.toFixed(3):m.toFixed(4),J=(m,d)=>{const o={...m};return d==="nodeMinSize"&&o.nodeMinSize>o.nodeMaxSize&&(o.nodeMaxSize=o.nodeMinSize),d==="nodeMaxSize"&&o.nodeMaxSize<o.nodeMinSize&&(o.nodeMinSize=o.nodeMaxSize),o.mobileConnectionDistance>o.desktopConnectionDistance&&(o.mobileConnectionDistance=o.desktopConnectionDistance),o.mobileClumpNeighborDistance>o.desktopClumpNeighborDistance&&(o.mobileClumpNeighborDistance=o.desktopClumpNeighborDistance),o},ee=({showControls:m=!1})=>{const d=c.useRef(null),o=c.useRef([]),y=c.useRef([]),L=c.useRef({x:0,y:0}),S=c.useRef(()=>{}),[v,A]=c.useState(()=>B),M=c.useRef(v),[j,O]=c.useState(!1),D=c.useRef(!1);c.useEffect(()=>{M.current=v},[v]),c.useEffect(()=>{const i=e=>{const u=e.detail;A(u),M.current=u,S.current()};return window.addEventListener(P,i),()=>window.removeEventListener(P,i)},[]),c.useEffect(()=>(_||(_=!0,D.current=!0),()=>{D.current&&(_=!1,D.current=!1)}),[]),c.useEffect(()=>{if(!D.current)return;const i=e=>{const u=e.target;u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement||u instanceof HTMLSelectElement||u?.isContentEditable||e.metaKey||e.ctrlKey||e.altKey||e.key.toLowerCase()==="f"&&(e.preventDefault(),O(C=>!C))};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[]);const H=(i,e,u)=>{A(N=>{const C=u?Math.round(e):e,f=J({...N,[i]:C},i);return B=f,M.current=f,window.dispatchEvent(new CustomEvent(P,{detail:f})),S.current(),f})},q=()=>{const i={...W};B=i,M.current=i,A(i),window.dispatchEvent(new CustomEvent(P,{detail:i})),S.current()};return c.useEffect(()=>{const i=d.current;if(!i)return;const e=i.getContext("2d");if(!e)return;const u=()=>{const n=M.current;o.current=[],y.current=[];const p=i.getBoundingClientRect(),E=i.width=p.width,F=i.height=p.height,z=window.innerWidth<=n.mobileMaxWidth?n.mobileParticleCount:n.desktopParticleCount;for(let R=0;R<z;R++)o.current.push({x:Math.random()*E,y:Math.random()*F,vx:(Math.random()-.5)*.5,vy:(Math.random()-.5)*.5,size:Math.random()*(n.nodeMaxSize-n.nodeMinSize)+n.nodeMinSize,alpha:Math.random()*n.nodeAlphaRange+n.nodeMinAlpha})};S.current=u;const N=()=>{if(!e||!i)return;const n=M.current,p=window.innerWidth<=n.mobileMaxWidth,E=p?n.mobileConnectionDistance:n.desktopConnectionDistance,F=p?n.mobileClumpNeighborDistance:n.desktopClumpNeighborDistance,$=p?n.mobileClumpMinNeighbors:n.desktopClumpMinNeighbors,z=i.width,R=i.height;e.clearRect(0,0,z,R);const g=o.current.length,T=new Array(g).fill(0),G=new Array(g).fill(!1);o.current.forEach(t=>{t.x+=t.vx,t.y+=t.vy,(t.x<0||t.x>z)&&(t.vx*=-1),(t.y<0||t.y>R)&&(t.vy*=-1);const s=L.current.x-t.x,a=L.current.y-t.y,r=Math.sqrt(s*s+a*a);r<n.attractionDistance&&(t.vx+=s/r*n.attractionForce,t.vy+=a/r*n.attractionForce),t.vx*=n.velocityDamping,t.vy*=n.velocityDamping});for(let t=0;t<g;t++){const s=o.current[t];for(let a=t+1;a<g;a++){const r=o.current[a],h=s.x-r.x,x=s.y-r.y;Math.sqrt(h*h+x*x)<F&&(T[t]++,T[a]++)}}for(let t=0;t<g;t++){const s=o.current[t],a=T[t]>=$;G[t]=a,e.beginPath(),e.arc(s.x,s.y,s.size,0,Math.PI*2),e.fillStyle=a?`rgba(${K}, ${Math.min(s.alpha+.18,.9)})`:`rgba(${U}, ${Math.min(s.alpha+.06,.7)})`,e.fill()}for(let t=0;t<g;t++){const s=o.current[t];for(let a=t+1;a<g;a++){const r=o.current[a],h=s.x-r.x,x=s.y-r.y,b=Math.sqrt(h*h+x*x);if(b<E&&(e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(r.x,r.y),e.strokeStyle=`rgba(${V}, ${(1-b/E)*n.linkOpacity})`,e.lineWidth=1,e.stroke(),G[t]&&G[a]&&b>n.pulseMinLinkDistance&&y.current.length<n.maxActivePulses&&Math.random()<n.pulseSpawnChance&&y.current.push({p1:s,p2:r,progress:0})),b<n.repulsionDistance){const k=Math.atan2(x,h),w=(n.repulsionDistance-b)*n.repulsionForce;s.vx+=Math.cos(k)*w,s.vy+=Math.sin(k)*w,r.vx-=Math.cos(k)*w,r.vy-=Math.sin(k)*w}}}for(let t=y.current.length-1;t>=0;t--){const s=y.current[t];s.progress+=n.pulseSpeed;const a=s.p2.x-s.p1.x,r=s.p2.y-s.p1.y,h=Math.sqrt(a*a+r*r);if(s.progress>=h){y.current.splice(t,1);continue}const x=s.progress/h,b=s.p1.x+a*x,k=s.p1.y+r*x,w=Math.atan2(r,a);e.save(),e.translate(b,k),e.rotate(w),e.beginPath(),e.ellipse(0,0,n.pulseGlowRadius*2.2,Math.max(n.pulseGlowRadius*.8,.8),0,0,Math.PI*2),e.fillStyle=`rgba(${I}, 0.18)`,e.fill(),e.beginPath(),e.ellipse(0,0,n.pulseCoreRadius*2.4,Math.max(n.pulseCoreRadius*.9,.6),0,0,Math.PI*2),e.fillStyle=`rgba(${I}, 0.9)`,e.shadowColor=`rgba(${I}, 0.6)`,e.shadowBlur=14,e.fill(),e.restore()}requestAnimationFrame(N)},C=()=>u(),f=n=>{const p=d.current?.getBoundingClientRect();p&&(L.current={x:n.clientX-p.left,y:n.clientY-p.top})};return window.addEventListener("resize",C),window.addEventListener("mousemove",f),u(),N(),()=>{window.removeEventListener("resize",C),window.removeEventListener("mousemove",f)}},[]),l.jsxs(l.Fragment,{children:[l.jsx("canvas",{ref:d,className:"absolute top-0 left-0 w-full h-full pointer-events-none z-0",style:{width:"100%",height:"100%"}}),(m||D.current&&j)&&l.jsxs("div",{className:"absolute right-3 top-3 z-40 pointer-events-auto md:right-5 md:top-5",children:[m&&l.jsx("button",{type:"button",onClick:()=>O(i=>!i),className:"rounded-full bg-stone-50/90 border border-stone-300 text-slate-700 px-4 h-10 text-xs font-semibold tracking-wide uppercase shadow-md backdrop-blur-sm hover:bg-stone-100/95 transition-colors",children:j?"Hide controls":"Tune vector field"}),j&&l.jsxs("div",{className:"mt-2 w-[320px] max-h-[70vh] overflow-y-auto rounded-2xl bg-stone-50/95 border border-stone-300 shadow-xl backdrop-blur-md p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Vector Controls"}),l.jsx("button",{type:"button",onClick:q,className:"text-xs font-medium text-[#00A3AD] hover:text-[#008A92]",children:"Reset defaults"})]}),l.jsx("div",{className:"space-y-3",children:Y.map(i=>l.jsxs("label",{className:"block",children:[l.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-600 mb-1.5",children:[l.jsx("span",{children:i.label}),l.jsx("span",{className:"font-mono text-slate-700",children:X(v[i.key],i.step)})]}),l.jsx("input",{type:"range",min:i.min,max:i.max,step:i.step,value:v[i.key],onChange:e=>H(i.key,Number(e.target.value),i.integer),className:"w-full accent-[#00A3AD]"})]},i.key))})]})]})]})};export{ee as VectorFieldBackground};
